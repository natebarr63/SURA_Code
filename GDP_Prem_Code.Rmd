---
title: "GDP_Prem_Tests"
author: "Nathan Barretto"
date: "2024-05-19"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
#importing the two datasets: GDP data and Veronesi data 
proxy_data <- read_csv("data_policycle.csv")
gdp_data <- read_csv("USGDP.csv")
combined_data <- merge(proxy_data, gdp_data)

```



```{r}
#invert rows and columns for gdp dataset
#source: https://stackoverflow.com/questions/33643181/how-do-i-flip-rows-and-columns-in-r
gdp_data_2 <- data.frame(t(gdp_data[-1]))
colnames(gdp_data) <- gdp_data[, 1]
```

```{r}
#rename columns in proxy dataset

#first column name changed to year_month
colnames(proxy_data)[1] <- "quarter_year"

```

```{r}
#adjust column names in gdp dataset to get the names of the columns to be that 
#of the first row names

for (x in 3:38) {
  name <- gdp_data_2[1,x]
  name_string <- toString(name) 
  colnames(gdp_data_2)[x] <- name_string
}
```


```{r}
#Adjust column names in proxy and gdp data to accurately reflect measurements
colnames(proxy_data)[67] <- "DPRatio"
#one-year equity premium bound proposed by Ian Martin in 2017
colnames(proxy_data)[70] <- "EP_Bound"
colnames(proxy_data)[47] <- "IPO_Gross"
colnames(proxy_data)[75] <- "Price_Volatile_Stocks"
colnames(proxy_data)[69] <- "Surplus_Cons_Ratio"
colnames(proxy_data)[76] <- "Agreggate_Risk_Aversion"
colnames(proxy_data)[19] <- "Unemployment_Rate"
colnames(gdp_data_2)[5] <- "GDP"
```


```{r}
#delete row 1 of gdp_data with the old names
gdp_data_2 <- gdp_data_2[-c(1), ]

```

```{r}
#delete first 2 columns of gdp_data
#Blank cells
gdp_data_2 <- gdp_data_2[ -c(1,2) ]
```



```{r}
#split proxy_data by quarter and year

#quarter makers function
quarter_makers = function(mths){
 q1_Vector <- c(1, 2, 3)
 q2_Vector <- c(4, 5, 6)
 q3_Vector <- c(7, 8, 9)
 q4_Vector <- c(10, 11, 12)
 
 result <- c()
 
 for(i in 1:length(mths)){
  if (mths[i] %in% q1_Vector ){
    result[i] <- "Q1"
  }
  else if (mths[i] %in% q2_Vector ){
    result[i] <- "Q2"
  }
  else if (mths[i] %in% q3_Vector ){
    result[i] <- "Q3"
  }
   else {
    result[i] <- "Q4"
   }
 }
 
 return (result)
}

```



```{r}
#Generate split of quarter and years using quarter makers function
proxy_data$months = as.numeric(substr(as.character(proxy_data$quarter_year),5,6))
proxy_data$Year = as.numeric(substr(as.character(proxy_data$quarter_year),1,4))
proxy_data$Quarter = quarter_makers(proxy_data$months)
```

```{r}
#download hmisc package
install.packages("Hmisc")
install.packages("acepack")
```


```{r}
#Modify both datasets so they include the same quarters from 1960 - 2015
#results in same dimensions for statistical analysis later
proxy_data_mod_final <- proxy_data[-c(1: 395), ]
```


```{r}
#Modify both datasets so they include the same quarters from 1960 - 2015
#results in same dimensions for statistical analysis later
gdp_data_mod_final <- gdp_data_2[-c(1: 51), ]
```

```{r}
#Modify both datasets so they include the same quarters from 1960 - 2015
#results in same dimensions for statistical analysis later
gdp_data_mod_final <- gdp_data_mod_final[-c(225: 257), ]
```

```{r}
#Create geometric mean function to get geometric mean for quarters 
#for proxy_data
geom_mean = function(months){
  result <- c()
  i = 1
  while(i < length(months)) {
    total <- c()
    for (j in 0:2){
      len_total <- length(total)
      total[[len_total + 1]] <- as.numeric(months[i + j])
    }
    value = exp(mean(log(as.numeric(total))))
    len_result <- length(result)
    result[[len_result + 1]] <- value
    i = i + 3
  }
  return (as.numeric(result))
}

```

```{r}
#Create arithmetic mean function to get arithmetic mean for quarters 
#for proxy_data
#Will use this for proxy measures that have negative values
ari_mean = function(months){
  result <- c()
  i = 1
  while(i < length(months)) {
    total <- c()
    for (j in 0:2){
      len_total <- length(total)
      total[[len_total + 1]] <- as.numeric(months[i + j])
    }
    value = mean(as.numeric(total))
    len_result <- length(result)
    result[[len_result + 1]] <- value
    i = i + 3
  }
  return (as.numeric(result))
}

```






```{r}
#Since each measure in the proxy dataset has different missing values/ years with data filled in,
#I will split the large, combined dataset into smaller individual datasets by specific 
#proxy measure


#The 7 measures and their respective datasets:
  
#1. IPOGross (Gross Initial Public Offering), name: combined_data_IPO_Gross
#2. Aggregate ,  name: combined_data_Agreggate_Risk_Aversion
#3. DP (Dividend Price Ratio),  name: combined_data_DPRatio
#4. EPBound (Equity Premium Bound),  name: combined_data_EPBound
#5. SCR (Surplus Consumption Ratio),  name: combined_data_surplus
#6. UNE (Unemployment Rate),  name: combined_data_UNE
#7. PVS (Price of Volatile Stocks),  name: combined_data_PVS
```



```{r}
#Apply geom mean function to different proxy measures by quarter average and
#add them to new, cumulative dataset with that measure for testing
combined_data_IPO_Gross <- data.frame(gdp_data_mod_final)
#Gross IPO By Quarter Added
combined_data_IPO_Gross$IPO_Gross = geom_mean(proxy_data_mod_final$IPO_Gross)
#remove original combined dataset
rm(combined_data)
#
```


```{r}
#Apply geom mean function to different proxy measures by quarter average and
#add them to new, cumulative dataset
#Aggregate Risk Aversion only has data from 1990 - 2010
#Start by changing gdp_data to only include this 
combined_data_Aggregate_Risk_Aversion <- data.frame(gdp_data_mod_final)
combined_data_Aggregate_Risk_Aversion <- combined_data_Aggregate_Risk_Aversion[-c(1: 120), ]
combined_data_Aggregate_Risk_Aversion <- combined_data_Aggregate_Risk_Aversion[-c(85: 104), ]
#Do the same for the proxy data 
proxy_data_cut <- data.frame(proxy_data_mod_final)
proxy_data_cut <- proxy_data_cut[-c(613: 672), ]
proxy_data_cut <- proxy_data_cut[-c(1: 360), ]
#Since aggregate risk aversion has negatives use arithmetic mean for quarter averages
#Aggregate Risk Aversion By Quarter Added
combined_data_Aggregate_Risk_Aversion$Aggregate_Risk_Aversion = ari_mean(proxy_data_cut$Agreggate_Risk_Aversion)
#
```


```{r}
#Apply geom mean function to different proxy measures by quarter average and
#add them to new, cumulative dataset with that measure for testing
combined_data_DPRatio <- data.frame(gdp_data_mod_final)
#DPRatio By Quarter Added
combined_data_DPRatio$DPRatio = geom_mean(proxy_data_mod_final$DPRatio)
```

```{r}
#Apply geom mean function to different proxy measures by quarter average and
#add them to new, cumulative dataset
#Equity Premium Bound only has data from 1996 - 2011
#Start by changing gdp_data to only include this 
combined_data_EPBound <- data.frame(gdp_data_mod_final)
combined_data_EPBound <- combined_data_EPBound[-c(1: 144), ]
combined_data_EPBound <- combined_data_EPBound[-c(65: 80), ]
#Do the same for the proxy data 
proxy_data_cut <- data.frame(proxy_data_mod_final)
proxy_data_cut <- proxy_data_cut[-c(625: 672), ]
proxy_data_cut <- proxy_data_cut[-c(1: 432), ]
#Equity Premium Bound By Quarter Added
combined_data_EPBound$EPBound = geom_mean(proxy_data_cut$EP_Bound)
#
```



```{r}
#Apply geom mean function to different proxy measures by quarter average and
#add them to new, cumulative dataset with that measure for testing
combined_data_SCR <- data.frame(gdp_data_mod_final)
#Surplus Consumption Ratio By Quarter Added
#negative values so use arithmetic mean
combined_data_SCR$SCR = ari_mean(proxy_data_mod_final$Surplus_Cons_Ratio)

```

```{r}
#Apply geom mean function to different proxy measures by quarter average and
#add them to new, cumulative dataset with that measure for testing
combined_data_UNE <- data.frame(gdp_data_mod_final)
#Unemployment Rate By Quarter Added
combined_data_UNE$UNE = geom_mean(proxy_data_mod_final$Unemployment_Rate)

```



```{r}
#Apply geom mean function to different proxy measures by quarter average and
#add them to new, cumulative dataset with that measure for testing
#PVS only has data from 1970 quarter 2, and is itself only available by quarter
combined_data_PVS <- data.frame(gdp_data_mod_final)
combined_data_PVS <- combined_data_PVS[-c(1: 41), ]
proxy_data_cut <- data.frame(proxy_data_mod_final)
proxy_data_cut <- proxy_data_cut[-c(1: 123), ]
#Run a for loop to keep every third row with the pvs data of the quarter in 
#the proxy dataset
 i = 3
 total <- c()
 while(i <= length(proxy_data_cut$Price_Volatile_Stocks)) {
    value = proxy_data_cut$Price_Volatile_Stocks[i]
    len_total <- length(total)
    total[[len_total + 1]] <- value
    i = i + 3
  }
#Price of Volatile Stock By Quarter Added
combined_data_PVS$PVS = total

```

```{r}
#All datasets now completed, can begin running tests
```


```{r}

#Equity Premium Proxy Measure 1: Gross IPO, all tests and graphs below


```


```{r}
#Start with an anova test for Gross IPO

#1: Anova test on the quarters to see if there is difference in the Gross IPO 
#by time in the year

IPO.aov <- aov(IPO_Gross ~ Quarter, data = combined_data_IPO_Gross)
# Summary
summary(IPO.aov)


```
```{r}
#P-value of 0.351. Indicates that there are no significant differences in the 
#mean gross ipo by quarter 
```



```{r}
#boxplots of the quarter ~ gross ipo relationship
#Notes: Outliers present for Q3 and Q4
#Notes: Q1 most similar to Q3, Q2 most similar to Q4
#Notes: Potential oscillation between quarters?
boxplot(IPO_Gross~Quarter,data=combined_data_IPO_Gross, main="Gross IPO vs Yearly Quarter",
   xlab="Quarter", ylab="Gross IPO")
```

```{r}
#Run correlation tests between different GDP measures and gross IPO
#Years: 1960 to 2015
#Correlation with GNP
cor(combined_data_IPO_Gross$IPO_Gross, as.numeric(combined_data_IPO_Gross$Gross.national.product))

#Correlation with GDP
cor(combined_data_IPO_Gross$IPO_Gross,  as.numeric(combined_data_IPO_Gross$GDP))

#Correlation with GPDI
cor(combined_data_IPO_Gross$IPO_Gross, as.numeric(combined_data_IPO_Gross$Gross.private.domestic.investment))

#Correlation with nondurable goods
cor(combined_data_IPO_Gross$IPO_Gross, as.numeric(combined_data_IPO_Gross$Nondurable.goods))


#Correlation with personal consumption expenditures
cor(combined_data_IPO_Gross$IPO_Gross, as.numeric(combined_data_IPO_Gross$Personal.consumption.expenditures))

```
```{r}
#all negative correlations around -0.2, indicates weak, negative correlation
```

```{r}
#Linear regression tests
#Start with gross ipo and GNP
lmIPO_GNP = lm(as.numeric(Gross.national.product) ~ IPO_Gross, data = combined_data_IPO_Gross) 
summary(lmIPO_GNP) 

#try with no intercept now
lmIPO_GNP_NOINT = lm(as.numeric(Gross.national.product) ~ IPO_Gross - 1, data = combined_data_IPO_Gross) 
summary(lmIPO_GNP_NOINT) 
```

```{r}
#Linear regression tests
#gross ipo and gdp
lmIPO_GDP = lm(as.numeric(GDP) ~ IPO_Gross, data = combined_data_IPO_Gross) 
summary(lmIPO_GDP) 

#try with no intercept now (X - 1)
lmIPO_GDP_NOINT = lm(as.numeric(GDP) ~ IPO_Gross - 1, data = combined_data_IPO_Gross) 
summary(lmIPO_GDP_NOINT) 
```

```{r}
#Linear regression tests
#gross ipo and Gross private domestic investment
lmIPO_GDP = lm(as.numeric(Gross.private.domestic.investment) ~ IPO_Gross, data = combined_data_IPO_Gross) 
summary(lmIPO_GDP) 

#try with no intercept now (X - 1)
lmIPO_GPDI_NOINT = lm(as.numeric(Gross.private.domestic.investment) ~ IPO_Gross - 1, data = combined_data_IPO_Gross) 
summary(lmIPO_GPDI_NOINT) 
```
```{r}
#Linear regression tests
#gross ipo and nondurable goods
lmIPO_NDG = lm(as.numeric(Nondurable.goods) ~ IPO_Gross, data = combined_data_IPO_Gross) 
summary(lmIPO_NDG) 

#try with no intercept now (X - 1)
lmIPO_NDG_NOINT = lm(as.numeric(Nondurable.goods) ~ IPO_Gross - 1, data = combined_data_IPO_Gross) 
summary(lmIPO_NDG_NOINT) 
```
```{r}
#Linear regression tests
#gross ipo and personal consumption expenditures
lmIPO_PCE = lm(as.numeric(Personal.consumption.expenditures) ~ IPO_Gross, data = combined_data_IPO_Gross) 
summary(lmIPO_PCE) 

#try with no intercept now (X - 1)
lmIPO_PCE_NOINT = lm(as.numeric(Personal.consumption.expenditures) ~ IPO_Gross - 1, data = combined_data_IPO_Gross) 
summary(lmIPO_PCE_NOINT) 
```



```{r}
#Make scatterplots of relationships, color by quarter
#Start with IPO Gross and GNP
 combined_data_IPO_Gross|>
  ggplot(aes(x = IPO_Gross, y = Gross.national.product,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Gross IPO", y = "GNP", color = "Quarter", 
       title = "Gross IPO vs Gross National Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and GDP
 combined_data_IPO_Gross|>
  ggplot(aes(x = IPO_Gross, y = GDP,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Gross IPO", y = "GDP", color = "Quarter", 
       title = "Gross IPO vs Gross Domestic Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and GPDI
 combined_data_IPO_Gross|>
  ggplot(aes(x = IPO_Gross, y = Gross.private.domestic.investment,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Gross IPO", y = "Gross private domestic investment", color = "Quarter", 
       title = "Gross IPO vs Gross private domestic investment by Quarter")
```
```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and Nondurable Goods
 combined_data_IPO_Gross|>
  ggplot(aes(x = IPO_Gross, y = Nondurable.goods,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Gross IPO", y = "Nondurable Goods", color = "Quarter", 
       title = "Gross IPO vs Nondurable Goods by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and Personal consumption expenditures
 combined_data_IPO_Gross|>
  ggplot(aes(x = IPO_Gross, y = Personal.consumption.expenditures,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Gross IPO", y = "Personal consumption expenditures", color = "Quarter", 
       title = "Gross IPO vs Personal Consumption Expenditures by Quarter")
```


```{r}

#Equity Premium Proxy Measure 2: Dividend Price ratio, all tests and graphs below


```

```{r}
#Start with an anova test for DP ratio

#1: Anova test on the quarters to see if there is difference in the DP Ratio
#by time in the year

DP.aov <- aov(DPRatio ~ Quarter, data = combined_data_DPRatio)
# Summary
summary(DP.aov)


```
```{r}
#P-value of 0.996. Indicates that there are no significant differences in the 
#mean DP Ratio by quarter 
```



```{r}
#boxplots of the quarter ~ gross ipo relationship
#Notes: No real Outliers 
#Notes: Almost all 4 quarters identical
#Notes: No real oscillation between quarters like with gross IPO
#Notes: Q3 has the smallest IQR
boxplot(DPRatio~Quarter,data=combined_data_DPRatio, main="DP Ratio vs Yearly Quarter",
   xlab="Quarter", ylab="DP Ratio")
```

```{r}
#Run correlation tests between different GDP measures and DPRatio
#Years: 1960 to 2015 (Full Data)
#Correlation with GNP
cor(combined_data_DPRatio$DPRatio, as.numeric(combined_data_DPRatio$Gross.national.product))

#Correlation with GDP
cor(combined_data_DPRatio$DPRatio,  as.numeric(combined_data_DPRatio$GDP))

#Correlation with GPDI
cor(combined_data_DPRatio$DPRatio, as.numeric(combined_data_DPRatio$Gross.private.domestic.investment))

#Correlation with nondurable goods
cor(combined_data_DPRatio$DPRatio, as.numeric(combined_data_DPRatio$Nondurable.goods))


#Correlation with personal consumption expenditures
cor(combined_data_DPRatio$DPRatio, as.numeric(combined_data_DPRatio$Personal.consumption.expenditures))

```
```{r}
#Notes: All positive correlations, greater than 0.6 for GDP, GNP, and Personal consumption expenditures indicating 
#indicating strong correlations with those items
```


```{r}
#Linear regression tests
#Start with DPRatio and GNP
lmDP_GNP = lm(as.numeric(Gross.national.product) ~ DPRatio, data = combined_data_DPRatio) 
summary(lmDP_GNP) 

#try with no intercept now
lmDP_GNP_NOINT = lm(as.numeric(Gross.national.product) ~ DPRatio - 1, data = combined_data_DPRatio) 
summary(lmDP_GNP_NOINT) 
```

```{r}
#Linear regression tests
#DPRatio and gdp
lmDP_GDP = lm(as.numeric(GDP) ~ DPRatio, data = combined_data_DPRatio) 
summary(lmDP_GDP) 

#try with no intercept now (X - 1)
lmDP_GDP_NOINT = lm(as.numeric(GDP) ~ DPRatio - 1, data = combined_data_DPRatio) 
summary(lmDP_GDP_NOINT) 
```

```{r}
#Linear regression tests
#DPRatio and Gross private domestic investment
lmDP_GPDI = lm(as.numeric(Gross.private.domestic.investment) ~ DPRatio, data = combined_data_DPRatio) 
summary(lmDP_GPDI) 

#try with no intercept now (X - 1)
lmDP_GPDI_NOINT = lm(as.numeric(Gross.private.domestic.investment) ~ DPRatio - 1, data = combined_data_DPRatio) 
summary(lmDP_GPDI_NOINT) 
```
```{r}
#Linear regression tests
#DPRatio and nondurable goods
lmDP_NDG = lm(as.numeric(Nondurable.goods) ~ DPRatio, data = combined_data_DPRatio) 
summary(lmDP_NDG) 

#try with no intercept now (X - 1)
lmDP_NDG_NOINT = lm(as.numeric(Nondurable.goods) ~ DPRatio - 1, data = combined_data_DPRatio) 
summary(lmDP_NDG_NOINT) 
```
```{r}
#Linear regression tests
#gross ipo and personal consumption expenditures
lmDP_PCE = lm(as.numeric(Personal.consumption.expenditures) ~ DPRatio, data = combined_data_DPRatio) 
summary(lmDP_PCE) 

#try with no intercept now (X - 1)
lmDP_PCE_NOINT = lm(as.numeric(Personal.consumption.expenditures) ~ DPRatio - 1, data = combined_data_DPRatio) 
summary(lmDP_PCE_NOINT) 
```

```{r}
#Make scatterplots of relationships, color by quarter
#Start with DPRatio and GNP
 combined_data_DPRatio|>
  ggplot(aes(x = DPRatio, y = Gross.national.product,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "DPRatio", y = "GNP", color = "Quarter", 
       title = "DPRatio vs Gross National Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#DPRatio and GDP
 combined_data_DPRatio|>
  ggplot(aes(x = DPRatio, y = GDP,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "DPRatio", y = "GDP", color = "Quarter", 
       title = "DPRatio vs Gross Domestic Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and GPDI
 combined_data_DPRatio|>
  ggplot(aes(x = DPRatio, y = Gross.private.domestic.investment,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "DPRatio", y = "Gross private domestic investment", color = "Quarter", 
       title = "DPRatio vs Gross private domestic investment by Quarter")
```
```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and Nondurable Goods
 combined_data_DPRatio|>
  ggplot(aes(x = DPRatio, y = Nondurable.goods,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "DPRatio", y = "Nondurable Goods", color = "Quarter", 
       title = "DPRatio vs Nondurable Goods by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and Personal consumption expenditures
 combined_data_DPRatio|>
  ggplot(aes(x = DPRatio, y = Personal.consumption.expenditures,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "DPRatio", y = "Personal consumption expenditures", color = "Quarter", 
       title = "DPRatio vs Personal Consumption Expenditures by Quarter")
```

```{r}

#Equity Premium Proxy Measure 3: EPBound, all tests and graphs below


```

```{r}
#Start with an anova test for EPBound

#1: Anova test on the quarters to see if there is difference in the Gross IPO 
#by time in the year

EP.aov <- aov(EPBound ~ Quarter, data = combined_data_EPBound)
# Summary
summary(EP.aov)


```
```{r}
#P-value of 0.521. Indicates that there are no significant differences in the 
#mean gross EPBound by quarter 
```



```{r}
#boxplots of the quarter ~ gross ipo relationship
#Notes: Outliers present for all quarters
#Notes: Q1 and Q2 medians similiar, Q1 and Q4 similiar IQR's
#Notes: No distinguishable oscillation between quarters
boxplot( EPBound~Quarter,data=combined_data_EPBound, main="EPBound vs Yearly Quarter",
   xlab="Quarter", ylab=" EPBound")
```

```{r}
#Run correlation tests between different GDP measures and gross IPO
#Years: 1960 to 2015
#Correlation with GNP
cor(combined_data_EPBound$EPBound, as.numeric(combined_data_EPBound$Gross.national.product))

#Correlation with GDP
cor(combined_data_EPBound$EPBound,  as.numeric(combined_data_EPBound$GDP))

#Correlation with GPDI
cor(combined_data_EPBound$EPBound, as.numeric(combined_data_EPBound$Gross.private.domestic.investment))

#Correlation with nondurable goods
cor(combined_data_EPBound$EPBound, as.numeric(combined_data_EPBound$Nondurable.goods))


#Correlation with personal consumption expenditures
cor(combined_data_EPBound$EPBound, as.numeric(combined_data_EPBound$Personal.consumption.expenditures))

```
```{r}
#all negative correlations, personal consumption expenditures at -0.71 indicates strong negative relationship 
```


```{r}
#Linear regression tests
#Start with EPBound and GNP
lmEPBound_GNP = lm(as.numeric(Gross.national.product) ~ EPBound, data = combined_data_EPBound) 
summary(lmIPO_GNP) 

#try with no intercept now
lmEPBound_GNP_NOINT = lm(as.numeric(Gross.national.product) ~ EPBound - 1, data = combined_data_EPBound) 
summary(lmIPO_GNP_NOINT) 
```

```{r}
#Linear regression tests
#EPBound and gdp
lmEPBound_GDP = lm(as.numeric(GDP) ~ EPBound, data = combined_data_EPBound) 
summary(lmEPBound_GDP) 

#try with no intercept now (X - 1)
lmEPBound_GDP_NOINT = lm(as.numeric(GDP) ~ EPBound - 1, data = combined_data_EPBound) 
summary(lmEPBound_GDP_NOINT) 
```

```{r}
#Linear regression tests
#EPBound and Gross private domestic investment
lmEPBound_GDP = lm(as.numeric(Gross.private.domestic.investment) ~ EPBound, data = combined_data_EPBound) 
summary(lmEPBound_GDP) 

#try with no intercept now (X - 1)
lmEPBound_GPDI_NOINT = lm(as.numeric(Gross.private.domestic.investment) ~ EPBound - 1, data = combined_data_EPBound) 
summary(lmEPBound_GPDI_NOINT) 
```
```{r}
#Linear regression tests
#EPBound and nondurable goods
lmEPBound_NDG = lm(as.numeric(Nondurable.goods) ~ EPBound, data = combined_data_EPBound) 
summary(lmIPO_NDG) 

#try with no intercept now (X - 1)
lmEPBound_NDG_NOINT = lm(as.numeric(Nondurable.goods) ~ EPBound - 1, data = combined_data_EPBound) 
summary(lmEPBound_NDG_NOINT) 
```
```{r}
#Linear regression tests
#EPBound and personal consumption expenditures
lmEPBound_PCE = lm(as.numeric(Personal.consumption.expenditures) ~ EPBound, data = combined_data_EPBound) 
summary(lmEPBound_PCE) 

#try with no intercept now (X - 1)
lmEPBound_PCE_NOINT = lm(as.numeric(Personal.consumption.expenditures) ~ EPBound - 1, data = combined_data_EPBound) 
summary(lmEPBound_PCE_NOINT) 
```
```{r}
#Make scatterplots of relationships, color by quarter
#Start with IPO Gross and GNP
 combined_data_EPBound|>
  ggplot(aes(x = EPBound, y = Gross.national.product,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "EPBound", y = "GNP", color = "Quarter", 
       title = "EPBound vs Gross National Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and GDP
 combined_data_EPBound|>
  ggplot(aes(x = EPBound, y = GDP,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "EPBound", y = "GDP", color = "Quarter", 
       title = "EPBound vs Gross Domestic Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and GPDI
 combined_data_EPBound|>
  ggplot(aes(x = EPBound, y = Gross.private.domestic.investment,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "EPBound", y = "Gross private domestic investment", color = "Quarter", 
       title = "EPBound vs Gross private domestic investment by Quarter")
```
```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and Nondurable Goods
 combined_data_EPBound|>
  ggplot(aes(x = EPBound, y = Nondurable.goods,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "EPBound", y = "Nondurable Goods", color = "Quarter", 
       title = "EPBound vs Nondurable Goods by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and Personal consumption expenditures
 combined_data_EPBound|>
  ggplot(aes(x = EPBound, y = Personal.consumption.expenditures,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "EPBound", y = "Personal consumption expenditures", color = "Quarter", 
       title = "EPBound vs Personal Consumption Expenditures by Quarter")
```

```{r}

#Risk Aversion Measure 1: PVS, all tests and graphs below


```


```{r}
#Start with an anova test for PVS

#1: Anova test on the quarters to see if there is difference in the Gross IPO 
#by time in the year

PVS.aov <- aov(as.numeric(PVS) ~ Quarter, data = combined_data_PVS)
# Summary
summary(PVS.aov)


```
```{r}
#P-value of 0.288. Indicates that there are no significant differences in the 
#mean gross ipo by quarter 
```



```{r}
#boxplots of the quarter ~ PVS relationship
#Notes: Outliers present for Q1, Q2, and Q4
#Notes: Q4 has the biggest IQR
#Notes: No real oscillation between quarters
boxplot(as.numeric(PVS) ~Quarter,data=combined_data_PVS, main="PVS vs Yearly Quarter",
   xlab="Quarter", ylab="PVS")
```

```{r}
#Run correlation tests between different GDP measures and gross IPO
#Years: 1960 to 2015
#Correlation with GNP
cor(as.numeric(combined_data_PVS$PVS), as.numeric(combined_data_PVS$Gross.national.product))

#Correlation with GDP
cor(as.numeric(combined_data_PVS$PVS), as.numeric(combined_data_PVS$GDP))

#Correlation with GPDI
cor(as.numeric(combined_data_PVS$PVS), as.numeric(combined_data_PVS$Gross.private.domestic.investment))

#Correlation with nondurable goods
cor(as.numeric(combined_data_PVS$PVS), as.numeric(combined_data_PVS$Nondurable.goods))


#Correlation with personal consumption expenditures
cor(as.numeric(combined_data_PVS$PVS), as.numeric(combined_data_PVS$Personal.consumption.expenditures))

```
```{r}
#all positive correlations below 0.15, indicates weak, positive correlation
```

```{r}
#Linear regression tests
#Start with PVS and GNP
lmPVS_GNP = lm(as.numeric(Gross.national.product) ~ as.numeric(PVS), data = combined_data_PVS) 
summary(lmIPO_GNP) 

#try with no intercept now
lmPVS_GNP_NOINT = lm(as.numeric(Gross.national.product) ~ as.numeric(PVS) - 1, data = combined_data_PVS) 
summary(lmPVS_GNP_NOINT) 
```

```{r}
#Linear regression tests
#gross PVS and gdp
lmPVS_GDP = lm(as.numeric(GDP) ~ as.numeric(PVS), data = combined_data_PVS) 
summary(lmPVS_GDP) 

#try with no intercept now (X - 1)
lmPVS_GDP_NOINT = lm(as.numeric(GDP) ~ as.numeric(PVS) - 1, data = combined_data_PVS) 
summary(lmPVS_GDP_NOINT) 
```

```{r}
#Linear regression tests
#PVS and Gross private domestic investment
lmPVS_GDP = lm(as.numeric(Gross.private.domestic.investment) ~ as.numeric(PVS), data = combined_data_PVS) 
summary(lmPVS_GDP) 

#try with no intercept now (X - 1)
lmPVS_GPDI_NOINT = lm(as.numeric(Gross.private.domestic.investment) ~ as.numeric(PVS) - 1, data = combined_data_PVS) 
summary(lmPVS_GPDI_NOINT) 
```
```{r}
#Linear regression tests
#PVS and nondurable goods
lmPVS_NDG = lm(as.numeric(Nondurable.goods) ~ as.numeric(PVS), data = combined_data_PVS) 
summary(lmPVS_NDG) 

#try with no intercept now (X - 1)
lmPVS_NDG_NOINT = lm(as.numeric(Nondurable.goods) ~ as.numeric(PVS) - 1, data = combined_data_PVS) 
summary(lmPVS_NDG_NOINT) 
```
```{r}
#Linear regression tests
#PVS and personal consumption expenditures
lmPVS_PCE = lm(as.numeric(Personal.consumption.expenditures) ~ as.numeric(PVS), data = combined_data_PVS) 
summary(lmPVS_PCE) 

#try with no intercept now (X - 1)
lmPVS_PCE_NOINT = lm(as.numeric(Personal.consumption.expenditures) ~ as.numeric(PVS) - 1, data = combined_data_PVS) 
summary(lmPVS_PCE_NOINT) 
```
```{r}
#Make scatterplots of relationships, color by quarter
#Start with PVS and GNP
 combined_data_PVS|>
  ggplot(aes(x = as.numeric(PVS), y = Gross.national.product,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "PVS", y = "GNP", color = "Quarter", 
       title = "PVS vs Gross National Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and GDP
 combined_data_PVS|>
  ggplot(aes(x= as.numeric(PVS), y = GDP,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "PVS", y = "GDP", color = "Quarter", 
       title = "PVS vs Gross Domestic Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and GPDI
 combined_data_PVS|>
  ggplot(aes(x = as.numeric(PVS), y = Gross.private.domestic.investment,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "PVS", y = "Gross private domestic investment", color = "Quarter", 
       title = "PVS vs Gross private domestic investment by Quarter")
```
```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and Nondurable Goods
 combined_data_PVS|>
  ggplot(aes(x = as.numeric(PVS), y = Nondurable.goods,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "PVS", y = "Nondurable Goods", color = "Quarter", 
       title = "PVS vs Nondurable Goods by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#IPO Gross and Personal consumption expenditures
 combined_data_PVS|>
  ggplot(aes(x = as.numeric(PVS), y = Personal.consumption.expenditures,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "PVS", y = "Personal consumption expenditures", color = "Quarter", 
       title = "PVS vs Personal Consumption Expenditures by Quarter")
```
```{r}

#Risk Aversion Measure 2: Surplus Consumption Ratio, all tests and graphs below


```


```{r}
#Start with an anova test for Surplus Consumption Ratio

#1: Anova test on the quarters to see if there is difference in the Surplus Consumption Ratio
#by time in the year

SCR.aov <- aov(SCR ~ Quarter, data = combined_data_SCR)
# Summary
summary(SCR.aov)


```
```{r}
#P-value of 0.986. Indicates that there are no significant differences in the 
#mean SCR by quarter 
```



```{r}
#boxplots of the quarter ~ gross ipo relationship
#Notes: Outliers present for Q1, Q2 and Q4
#Notes: All quarter IQR's about equal
#Notes: No tengible oscillation between quarters
boxplot(SCR~Quarter,data=combined_data_SCR, main="Surplus Consumption Ratio vs Yearly Quarter",
   xlab="Quarter", ylab="SCR")
```
```{r}
#Run correlation tests between different GDP measures and Surplus Consumption Ratio
#Years: 1960 to 2015 
#Correlation with GNP
cor(combined_data_SCR$SCR, as.numeric(combined_data_SCR$Gross.national.product))

#Correlation with GDP
cor(combined_data_SCR$SCR,  as.numeric(combined_data_SCR$GDP))

#Correlation with GPDI
cor(combined_data_SCR$SCR, as.numeric(combined_data_SCR$Gross.private.domestic.investment))

#Correlation with nondurable goods
cor(combined_data_SCR$SCR, as.numeric(combined_data_SCR$Nondurable.goods))


#Correlation with personal consumption expenditures
cor(combined_data_SCR$SCR, as.numeric(combined_data_SCR$Personal.consumption.expenditures))

```

```{r}
#Purely negative correlations with values strictly less than 0.15 (absolute value) indicating weak, negative associations
```

```{r}
#Linear regression tests
#Start with Surplus Consumption Ratio and GNP
lmSCR_GNP = lm(as.numeric(Gross.national.product) ~ SCR, data = combined_data_SCR) 
summary(lmIPO_GNP) 

#try with no intercept now
lmSCR_GNP_NOINT = lm(as.numeric(Gross.national.product) ~ SCR - 1, data = combined_data_SCR) 
summary(lmSCR_GNP_NOINT) 
```

```{r}
#Linear regression tests
#Surplus Consumption Ratio and gdp
lmSCR_GDP = lm(as.numeric(GDP) ~ SCR, data = combined_data_SCR) 
summary(lmSCR_GDP) 

#try with no intercept now (X - 1)
lmSCR_GDP_NOINT = lm(as.numeric(GDP) ~ SCR - 1, data = combined_data_SCR) 
summary(lmSCR_GDP_NOINT) 
```

```{r}
#Linear regression tests
#Surplus Consumption Ratio and Gross private domestic investment
lmSCR_GDPI = lm(as.numeric(Gross.private.domestic.investment) ~ SCR, data = combined_data_SCR) 
summary(lmSCR_GDPI) 

#try with no intercept now (X - 1)
lmSCR_GDPI_NOINT = lm(as.numeric(Gross.private.domestic.investment) ~ SCR - 1, data = combined_data_SCR) 
summary(lmSCR_GDPI_NOINT) 
```
```{r}
#Linear regression tests
#Surplus Consumption Ratio and nondurable goods
lmSCR_NDG = lm(as.numeric(Nondurable.goods) ~ SCR, data = combined_data_SCR) 
summary(lmSCR_NDG) 

#try with no intercept now (X - 1)
lmSCR_NDG_NOINT = lm(as.numeric(Nondurable.goods) ~ SCR - 1, data = combined_data_SCR) 
summary(lmSCR_NDG_NOINT) 
```
```{r}
#Linear regression tests
#Surplus Consumption Ratio and personal consumption expenditures
lmSCR_PCE = lm(as.numeric(Personal.consumption.expenditures) ~ SCR, data = combined_data_SCR) 
summary(lmSCR_PCE) 

#try with no intercept now (X - 1)
lmSCR_PCE_NOINT = lm(as.numeric(Personal.consumption.expenditures) ~ SCR - 1, data = combined_data_SCR) 
summary(lmSCR_PCE_NOINT) 
```
```{r}
#Make scatterplots of relationships, color by quarter
#Start with SCR and GNP
 combined_data_SCR|>
  ggplot(aes(x = SCR, y = Gross.national.product,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "SCR", y = "GNP", color = "Quarter", 
       title = "SCR vs Gross National Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#SCR and GDP
 combined_data_SCR|>
  ggplot(aes(x = SCR, y = GDP,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "SCR", y = "GDP", color = "Quarter", 
       title = "SCR vs Gross Domestic Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#SCR and GPDI
 combined_data_SCR|> 
  ggplot(aes(x = SCR, y = Gross.private.domestic.investment,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "SCR", y = "Gross private domestic investment", color = "Quarter", 
       title = "SCR vs Gross private domestic investment by Quarter")
```
```{r}
#Make scatterplots of relationships, color by quarter
#SCR and Nondurable Goods
 combined_data_SCR|>
  ggplot(aes(x = SCR, y = Nondurable.goods,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "SCR", y = "Nondurable Goods", color = "Quarter", 
       title = "SCR vs Nondurable Goods by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#SCR and Personal consumption expenditures
 combined_data_SCR|>
  ggplot(aes(x = SCR, y = Personal.consumption.expenditures,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "SCR", y = "Personal consumption expenditures", color = "Quarter", 
       title = "SCR vs Personal Consumption Expenditures by Quarter")
```


```{r}

#Equity Premium Proxy Measure 3: Aggregate Risk Aversion, all tests and graphs below
rm(combined_data_Agreggate_Risk_Aversion)

```


```{r}
#Start with an anova test for Aggregate Risk Aversion

#1: Anova test on the quarters to see if there is difference in the Aggregate Risk Aversion 
#by time in the year

Aggregate_Risk_Aversion.aov <- aov(Aggregate_Risk_Aversion ~ Quarter, data = combined_data_Aggregate_Risk_Aversion)
# Summary
summary(Aggregate_Risk_Aversion.aov)


```
```{r}
#P-value of 0.963 indicates equal means approximately for risk aversion across quarters
```

```{r}
#Run correlation tests between different GDP measures and Aggregate Risk Aversion
#1990 to 2010
#Correlation with GNP
cor(combined_data_Aggregate_Risk_Aversion$Aggregate_Risk_Aversion, as.numeric(combined_data_Aggregate_Risk_Aversion$Gross.national.product))

#Correlation with GDP
cor(combined_data_Aggregate_Risk_Aversion$Aggregate_Risk_Aversion,  as.numeric(combined_data_Aggregate_Risk_Aversion$GDP))

#Correlation with GPDI
cor(combined_data_Aggregate_Risk_Aversion$Aggregate_Risk_Aversion, as.numeric(combined_data_Aggregate_Risk_Aversion$Gross.private.domestic.investment))

#Correlation with nondurable goods
cor(combined_data_Aggregate_Risk_Aversion$Aggregate_Risk_Aversion, as.numeric(combined_data_Aggregate_Risk_Aversion$Nondurable.goods))


#Correlation with personal consumption expenditures
cor(combined_data_Aggregate_Risk_Aversion$Aggregate_Risk_Aversion, as.numeric(combined_data_Aggregate_Risk_Aversion$Personal.consumption.expenditures))

```
```{r}
# Mix of positive and negative correlations but all below 0.2 (absolute value) so relatively weak associations
```

```{r}
#Linear regression tests
#Start with Aggregate Risk Aversion and GNP
lmAggregate_Risk_Aversion_GNP = lm(as.numeric(Gross.national.product) ~ Aggregate_Risk_Aversion, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_GNP) 

#try with no intercept now
lmAggregate_Risk_Aversion_GNP_NOINT = lm(as.numeric(Gross.national.product) ~ Aggregate_Risk_Aversion - 1, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_GNP_NOINT) 
```

```{r}
#Linear regression tests
#Aggregate Risk Aversion and gdp
lmAggregate_Risk_Aversion_GDP = lm(as.numeric(GDP) ~ Aggregate_Risk_Aversion, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_GDP) 

#try with no intercept now (X - 1)
lmAggregate_Risk_Aversion_GDP_NOINT = lm(as.numeric(GDP) ~ Aggregate_Risk_Aversion - 1, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_GDP_NOINT) 
```

```{r}
#Linear regression tests
#Aggregate Risk Aversion and Gross private domestic investment
lmAggregate_Risk_Aversion_GDP = lm(as.numeric(Gross.private.domestic.investment) ~ Aggregate_Risk_Aversion, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_GDP) 

#try with no intercept now (X - 1)
lmAggregate_Risk_Aversion_GPDI_NOINT = lm(as.numeric(Gross.private.domestic.investment) ~ Aggregate_Risk_Aversion - 1, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_GPDI_NOINT) 
```
```{r}
#Linear regression tests
#gross ipo and nondurable goods
lmAggregate_Risk_Aversion_NDG = lm(as.numeric(Nondurable.goods) ~ Aggregate_Risk_Aversion, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_NDG) 

#try with no intercept now (X - 1)
lmAggregate_Risk_Aversion_NDG_NOINT = lm(as.numeric(Nondurable.goods) ~ Aggregate_Risk_Aversion - 1, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_NDG_NOINT) 
```
```{r}
#Linear regression tests
#Aggregate Risk Aversion and personal consumption expenditures
lmAggregate_Risk_Aversion_PCE = lm(as.numeric(Personal.consumption.expenditures) ~ Aggregate_Risk_Aversion, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_PCE) 

#try with no intercept now (X - 1)
lmAggregate_Risk_Aversion_PCE_NOINT = lm(as.numeric(Personal.consumption.expenditures) ~ Aggregate_Risk_Aversion - 1, data = combined_data_Aggregate_Risk_Aversion) 
summary(lmAggregate_Risk_Aversion_PCE_NOINT) 
```


```{r}
#Make scatterplots of relationships, color by quarter
#Start with Aggregate Risk Aversion  and GNP
 combined_data_Aggregate_Risk_Aversion|>
  ggplot(aes(x = Aggregate_Risk_Aversion, y = Gross.national.product,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Aggregate Risk Aversion ", y = "GNP", color = "Quarter", 
       title = "Aggregate Risk Aversion  vs Gross National Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#Aggregate Risk Aversion  and GDP
 combined_data_Aggregate_Risk_Aversion|>
  ggplot(aes(x = Aggregate_Risk_Aversion, y = GDP,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Aggregate Risk Aversion ", y = "GDP", color = "Quarter", 
       title = "Aggregate Risk Aversion  vs Gross Domestic Product by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#Aggregate Risk Aversion  and GPDI
 combined_data_Aggregate_Risk_Aversion|> 
  ggplot(aes(x = Aggregate_Risk_Aversion, y = Gross.private.domestic.investment,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Aggregate Risk Aversion ", y = "Gross private domestic investment", color = "Quarter", 
       title = "Aggregate Risk Aversion  vs Gross private domestic investment by Quarter")
```
```{r}
#Make scatterplots of relationships, color by quarter
#Aggregate Risk Aversion  and Nondurable Goods
 combined_data_Aggregate_Risk_Aversion|>
  ggplot(aes(x = Aggregate_Risk_Aversion, y = Nondurable.goods,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Aggregate Risk Aversion ", y = "Nondurable Goods", color = "Quarter", 
       title = "Aggregate Risk Aversion  vs Nondurable Goods by Quarter")
```

```{r}
#Make scatterplots of relationships, color by quarter
#Aggregate Risk Aversion  and Personal consumption expenditures
 combined_data_Aggregate_Risk_Aversion|>
  ggplot(aes(x = Aggregate_Risk_Aversion, y = Personal.consumption.expenditures,
             color = Quarter)) +
  geom_point(alpha = 0.5) +
  labs(x = "Aggregate Risk Aversion ", y = "Personal consumption expenditures", color = "Quarter", 
       title = "Aggregate Risk Aversion  vs Personal Consumption Expenditures by Quarter")
```
